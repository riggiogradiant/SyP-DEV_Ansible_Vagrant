---
- name: Comprobar conectividad a VMs de Vagrant
  hosts: vagrant_vms
  gather_facts: yes 
  
  vars:
    # Variables simples
    mensaje_bienvenida: "Â¡Hola desde Ansible!"
    puerto_web: 80
    aplicacion: "Demo-App"
    version: "1.0.0"
    
    # Variables de lista
    servicios_requeridos:
      - nginx
      - mysql
      - php
    
    # Variables de diccionario
    info_servidor:
      tipo: "web"
      entorno: "desarrollo"
      responsable: "DevOps Team"
  
  tasks:
    - name: Hacer ping a las mÃ¡quinas virtuales
      ping:
      register: ping_result
      
    - name: Mostrar resultado del ping con variables
      debug:
        msg: |
          âœ… {{ mensaje_bienvenida }}
          ğŸ–¥ï¸  Servidor: {{ inventory_hostname }} ({{ ansible_host }})
          ğŸ“± AplicaciÃ³n: {{ aplicacion }} v{{ version }}
          ğŸŒ Puerto: {{ puerto_web }}
          ğŸ·ï¸  Tipo: {{ info_servidor.tipo }}
          ğŸ”§ Entorno: {{ info_servidor.entorno }}
      when: ping_result is succeeded
    
    - name: Mostrar informaciÃ³n del sistema usando facts
      debug:
        msg: |
          ğŸ’» Sistema Operativo: {{ ansible_distribution }} {{ ansible_distribution_version }}
          ğŸ  Hostname: {{ ansible_hostname }}
          ğŸ’¾ Memoria Total: {{ ansible_memtotal_mb }} MB
          ğŸ’¿ Espacio en disco: {{ ansible_mounts[0].size_total | human_readable }}
      when: ping_result is succeeded
    
    - name: Listar servicios requeridos
      debug:
        msg: "ğŸ”§ Servicio requerido: {{ item }}"
      loop: "{{ servicios_requeridos }}"
      when: ping_result is succeeded